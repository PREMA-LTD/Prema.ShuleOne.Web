<!-- student-registration.component.html -->
<div class="min-h-screen bg-gray-50 p-8">
    <mat-card class="max-w-2xl mx-auto">
        <mat-card-header>
            <mat-card-title class="w-full text-center text-2xl font-bold text-gray-800 mb-8">
                Payment Options
            </mat-card-title>
        </mat-card-header>

        <mat-card-content>
            <mat-tab-group>
                <!-- Tab 1: Mpesa Payment -->
                <mat-tab label="Initiate Payment">
                    <br/>
                    <div class="p-4">
                        <form [formGroup]="mpesaPaymentForm" class="flex flex-col gap-4">
                            <mat-form-field appearance="outline" class="w-full">
                                <mat-label>Fee Type</mat-label>
                                <input matInput formControlName="feeType" placeholder="Enter fee type">
                                <mat-error *ngIf="mpesaPaymentForm.get('feeType')?.errors?.['required']">
                                    Fee type is required
                                </mat-error>
                            </mat-form-field>

                            <mat-form-field appearance="outline" class="w-full">
                                <mat-label>Amount</mat-label>
                                <input matInput formControlName="amount" placeholder="Enter amount">
                                <mat-error *ngIf="mpesaPaymentForm.get('amount')?.errors?.['required']">
                                    Amount is required
                                </mat-error>
                            </mat-form-field>

                            <mat-form-field appearance="outline" class="w-full">
                                <mat-label>Mpesa Number (confirm number)</mat-label>
                                <input
                                    matInput
                                    formControlName="mpesaNumber"
                                    placeholder="Enter phone number"
                                    maxlength="10">
                                <mat-error
                                    *ngIf="mpesaPaymentForm.get('mpesaNumber')?.hasError('required')">
                                    Mpesa number is required
                                </mat-error>
                                <mat-error
                                    *ngIf="mpesaPaymentForm.get('mpesaNumber')?.hasError('pattern')">
                                    Invalid phone number
                                </mat-error>
                            </mat-form-field>

                            <!-- Navigation Buttons -->
                            <div class="flex justify-end mt-4">
                                <button mat-raised-button color="primary" (click)="initiateMpesaPrompt()">
                                    Initiate Mpesa Prompt
                                </button>
                                
                                <button mat-raised-button color="warn" (click)="close()">
                                    Close
                                </button>
                            </div>
                        </form>
                    </div>
                </mat-tab>
                    <mat-tab label="Manual Payment">
                        <br />
                        <div class="p-4">
                            <h3>Manual Payment Process</h3>
                            <ol>
                                <li>
                                    <p>Go to 'Lipa na Mpesa'</p>
                                </li>
                                <li>
                                    <p>Select 'Pay Bill'</p>
                                </li>
                                <li>
                                    <p>Enter business number </p><strong>4148215</strong>
                                </li>
                                <li>
                                    <p>Enter account number as </p><strong>admission</strong>
                                </li>
                                <li>
                                    <p>Enter fees amount as </p><strong>200</strong>
                                </li>
                                <li>
                                    <p>Enter your Mpesa PIN</p>
                                </li>
                                <li>
                                    <p>Confirm transaction</p>
                                </li>
                                <li>
                                    <p>Receive SMS confirmation</p>
                                </li>
                            </ol>
                            <!-- <button mat-raised-button color="primary" (click)="goToNextTab(tabGroup)">Check Payment</button> -->
                        </div>

                        <!-- Navigation Buttons -->
                        <div class="flex justify-end mt-4">
                            <button mat-raised-button color="warn" (click)="close()">
                                Close
                            </button>
                        </div>
                    </mat-tab>
                
                <!-- Tab 2: Bank Payment -->
                <mat-tab label="Check Payment">
                    <br/>
                    <div class="p-4">
                        <form [formGroup]="recordPaymentForm" class="flex flex-col gap-4">
                            <mat-form-field appearance="outline" class="w-full">
                                <mat-label>Mpesa Refrence</mat-label>
                                <input matInput formControlName="transactionRef" placeholder="Enter mpesa transaction refrence">
                                <mat-error *ngIf="recordPaymentForm.get('transactionRef')?.errors?.['required']">
                                    Enter mpesa transaction refrence
                                </mat-error>
                            </mat-form-field>

                            <!-- Navigation Buttons -->
                            <div class="flex justify-end mt-4">
                                <button mat-raised-button color="primary" (click)="recordPayment()">
                                    Check Payment
                                </button>
                                <button mat-raised-button color="warn" (click)="close()">
                                    Close
                                </button>
                            </div>
                        </form>
                    </div>
                </mat-tab>
            </mat-tab-group>
        </mat-card-content>
    </mat-card>
</div>
